{"ast":null,"code":"var _jsxFileName = \"/Users/hoanganh0722/Desktop/Web/gstorevn/src/components/Dashboard/FormPost/FormPost.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useCallback } from \"react\";\nimport Layout from \"../Layout/Layout\";\nimport Container from \"../helper/Container/Container\";\nimport { Button, TextField } from \"@material-ui/core\";\nimport styles from \"./FormPost.module.scss\";\nimport useInput from \"../../hook/use-input\";\nimport Files from \"./Files\";\nimport useHttp from \"../../hook/use-http\";\nimport { CSSTransition } from \"react-transition-group\";\nimport Inform from \"../ChangingPost/UI/Inform/Inform\";\nimport ReactDOM from \"react-dom\";\nimport OverlayPortals from \"../../Overlay/OverlayPortal\";\nimport Loading from '../../../UI/Loading/Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst FormPost = () => {\n  _s();\n\n  const [isValidImages, setIsValidImages] = useState(true);\n  const [statusUploading, setStatusUploading] = useState(null);\n  const [arrayOfImages, setArrayOfImages] = useState(null);\n  const contentRef = useRef('');\n  const contentNextRef = useRef('');\n  const contentThirdRef = useRef('');\n  const {\n    isValid,\n    isTouched,\n    inputIsTouchedHandler,\n    changeInputHandler,\n    valueInput\n  } = useInput(value => value.trim().length > 0);\n  const {\n    fetchingDataHandler,\n    data,\n    status,\n    error\n  } = useHttp();\n  const gettingFilesHandler = useCallback(files => {\n    setArrayOfImages(files);\n  }, []);\n\n  const submitHandler = async event => {\n    event.preventDefault();\n\n    if (!arrayOfImages || arrayOfImages.length < 3) {\n      setIsValidImages(false);\n      return;\n    }\n\n    setStatusUploading('pending');\n    const formData = new FormData();\n    arrayOfImages.forEach(items => {\n      formData.append(\"photos\", items);\n    });\n\n    try {\n      const response = await fetch(\"http://localhost:3001/api/upload-images\", {\n        method: \"POST\",\n        body: formData\n      });\n\n      if (!response.ok) {\n        throw new Error('error');\n      }\n\n      const dataImages = await response.json();\n      const arrayImages = [];\n      dataImages.forEach(items => {\n        arrayImages.push(items.filename);\n      });\n      fetchingDataHandler({\n        url: 'http://localhost:3001/api/create-post',\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: {\n          title: valueInput,\n          content1: contentRef.current.value,\n          content2: contentNextRef.current.value,\n          content3: contentThirdRef.current.value,\n          image1: arrayImages[0],\n          image2: arrayImages[1],\n          image3: arrayImages[2],\n          dateblog: new Date().toISOString(),\n          showed: true\n        }\n      });\n    } catch (err) {\n      setStatusUploading('error');\n    }\n\n    setStatusUploading('completed');\n  };\n\n  console.log(arrayOfImages);\n\n  const resetStateHandler = () => {\n    setStatusUploading(null);\n    setIsValidImages(true);\n  };\n\n  console.log(data);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [(statusUploading === 'pending' || status === 'pending') && /*#__PURE__*/_jsxDEV(Loading, {\n      className: styles.loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 65\n    }, this), /*#__PURE__*/_jsxDEV(Layout, {\n      title: \"T\\u1EA1o Blog\",\n      children: /*#__PURE__*/_jsxDEV(Container, {\n        className: styles.container,\n        children: [/*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: submitHandler,\n          className: styles.form,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"title\",\n            children: \"Ti\\xEAu \\u0111\\u1EC1 b\\xE0i vi\\u1EBFt\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"title\",\n            margin: \"normal\",\n            required: true,\n            label: \"Ti\\xEAu \\u0111\\u1EC1\",\n            variant: \"outlined\",\n            multiline: true,\n            placeholder: \"Ti\\xEAu \\u0110\\u1EC1\",\n            size: \"medium\",\n            fullWidth: true,\n            value: valueInput,\n            onChange: changeInputHandler,\n            onBlur: inputIsTouchedHandler,\n            error: !isValid && isTouched\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 11\n          }, this), !isValid && isTouched && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: styles.invalid,\n            children: \"Ti\\xEAu \\u0111\\u1EC1 kh\\xF4ng \\u0111\\u01B0\\u1EE3c \\u0111\\u1EC3 tr\\u1ED1ng\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"body-1\",\n            children: \"\\u0110o\\u1EA1n 1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"body-1\",\n            margin: \"normal\",\n            label: \"\\u0110o\\u1EA1n 1\",\n            variant: \"outlined\",\n            multiline: true,\n            placeholder: \"N\\u1ED9i Dung 1\",\n            size: \"medium\",\n            fullWidth: true,\n            inputRef: contentRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"body-2\",\n            children: \"\\u0110o\\u1EA1n 2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"body-2\",\n            margin: \"normal\",\n            label: \"\\u0110o\\u1EA1n 2\",\n            variant: \"outlined\",\n            multiline: true,\n            placeholder: \"N\\u1ED9i Dung 2\",\n            size: \"medium\",\n            fullWidth: true,\n            inputRef: contentNextRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"body-3\",\n            children: \"\\u0110o\\u1EA1n 3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            id: \"body-3\",\n            margin: \"normal\",\n            label: \"\\u0110o\\u1EA1n 3\",\n            variant: \"outlined\",\n            multiline: true,\n            placeholder: \"N\\u1ED9i Dung 3\",\n            size: \"medium\",\n            fullWidth: true,\n            inputRef: contentThirdRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Files, {\n            gettingFiles: gettingFilesHandler\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            className: styles.btn,\n            variant: \"contained\",\n            children: \"\\u0110\\u0103ng b\\xE0i!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(CSSTransition, {\n          in: statusUploading === 'error' || !isValidImages || data && status === 'completed' || error && status === 'error',\n          mountOnEnter: true,\n          unmountOnExit: true,\n          classNames: \"fade-light\",\n          timeout: 500,\n          children: /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(Inform, {\n              children: [!isValidImages && /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"Upload t\\u1ED1i thi\\u1EC3u 3 \\u1EA3nh!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 34\n              }, this), error && status === 'error' && /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"C\\xF3 l\\u1ED7i x\\u1EA3y ra, xin th\\u1EED l\\u1EA1i sau\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 47\n              }, this), data && status === 'completed' && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.success,\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"T\\u1EA3i b\\xE0i vi\\u1EBFt l\\xEAn th\\xE0nh c\\xF4ng\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 167,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: styles.information,\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    children: \"Th\\xF4ng tin b\\xE0i vi\\u1EBFt\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 19\n                  }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                      children: [\"Ti\\xEAu \\u0111\\u1EC1: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: data.title\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 171,\n                        columnNumber: 34\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 171,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: [\"N\\u1ED9i dung 1: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: data.content1\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 172,\n                        columnNumber: 37\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 172,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: [\"N\\u1ED9i dung 2: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: data.content2\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 173,\n                        columnNumber: 37\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 173,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: [\"N\\u1ED9i dung 3: \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: data.content3\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 174,\n                        columnNumber: 37\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 174,\n                      columnNumber: 21\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: resetStateHandler,\n                className: styles[\"btn-close\"],\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 183,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 13\n            }, this), /*#__PURE__*/ReactDOM.createPortal( /*#__PURE__*/_jsxDEV(OverlayPortals, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this), document.getElementById(\"overlay\"))]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n};\n\n_s(FormPost, \"QQEWce5jenqlH7rrenbjkCOvvnc=\", false, function () {\n  return [useInput, useHttp];\n});\n\n_c = FormPost;\nexport default FormPost;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormPost\");","map":{"version":3,"sources":["/Users/hoanganh0722/Desktop/Web/gstorevn/src/components/Dashboard/FormPost/FormPost.js"],"names":["React","useState","useRef","useCallback","Layout","Container","Button","TextField","styles","useInput","Files","useHttp","CSSTransition","Inform","ReactDOM","OverlayPortals","Loading","FormPost","isValidImages","setIsValidImages","statusUploading","setStatusUploading","arrayOfImages","setArrayOfImages","contentRef","contentNextRef","contentThirdRef","isValid","isTouched","inputIsTouchedHandler","changeInputHandler","valueInput","value","trim","length","fetchingDataHandler","data","status","error","gettingFilesHandler","files","submitHandler","event","preventDefault","formData","FormData","forEach","items","append","response","fetch","method","body","ok","Error","dataImages","json","arrayImages","push","filename","url","headers","title","content1","current","content2","content3","image1","image2","image3","dateblog","Date","toISOString","showed","err","console","log","resetStateHandler","loading","container","form","invalid","btn","success","information","createPortal","document","getElementById"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useCallback } from \"react\";\nimport Layout from \"../Layout/Layout\";\nimport Container from \"../helper/Container/Container\";\nimport { Button, TextField } from \"@material-ui/core\";\nimport styles from \"./FormPost.module.scss\";\nimport useInput from \"../../hook/use-input\";\nimport Files from \"./Files\";\nimport useHttp from \"../../hook/use-http\";\nimport { CSSTransition } from \"react-transition-group\";\nimport Inform from \"../ChangingPost/UI/Inform/Inform\";\nimport ReactDOM from \"react-dom\";\nimport OverlayPortals from \"../../Overlay/OverlayPortal\";\nimport Loading from '../../../UI/Loading/Loading';\nconst FormPost = () => {\n  const [isValidImages, setIsValidImages] = useState(true);\n  const [statusUploading, setStatusUploading] = useState(null);\n  const [arrayOfImages, setArrayOfImages] = useState(null);\n  const contentRef = useRef('');\n  const contentNextRef = useRef('');\n  const contentThirdRef = useRef('');\n  const {\n    isValid,\n    isTouched,\n    inputIsTouchedHandler,\n    changeInputHandler,\n    valueInput,\n  } = useInput((value) => value.trim().length > 0);\n  const {\n    fetchingDataHandler,\n    data,\n    status,\n    error\n  } = useHttp();\n  const gettingFilesHandler = useCallback((files) => {\n    setArrayOfImages(files);\n  }, []);\n  const submitHandler = async (event) => {\n    event.preventDefault();\n    if (!arrayOfImages || arrayOfImages.length < 3) {\n      setIsValidImages(false);\n      return;\n    }\n    setStatusUploading('pending');\n    const formData = new FormData();\n    arrayOfImages.forEach((items) => {\n      formData.append(\"photos\", items);\n    });\n    try {\n      const response = await fetch(\"http://localhost:3001/api/upload-images\", {\n        method: \"POST\",\n        body: formData,\n      });\n      if(!response.ok){\n        throw new Error('error');\n      }\n      const dataImages = await response.json();\n      const arrayImages = [];\n      dataImages.forEach(items =>{\n        arrayImages.push(items.filename);\n      })\n      fetchingDataHandler({\n        url: 'http://localhost:3001/api/create-post',\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: {\n          title: valueInput,\n          content1: contentRef.current.value,\n          content2: contentNextRef.current.value,\n          content3: contentThirdRef.current.value,\n          image1: arrayImages[0],\n          image2: arrayImages[1],\n          image3: arrayImages[2],\n          dateblog: new Date().toISOString(),\n          showed: true\n        }\n      })\n    } catch (err) {\n      setStatusUploading('error');\n    }\n    setStatusUploading('completed');\n  };\n  console.log(arrayOfImages);\n  const resetStateHandler = () =>{\n    setStatusUploading(null);\n    setIsValidImages(true);\n  }\n  console.log(data);\n  return (\n    <>\n    {(statusUploading === 'pending' || status === 'pending') && <Loading className={styles.loading}/>}\n    <Layout title=\"Tạo Blog\">\n      <Container className={styles.container}>\n        <form onSubmit={submitHandler} className={styles.form}>\n          <label htmlFor=\"title\">Tiêu đề bài viết</label>\n          <TextField\n            id=\"title\"\n            margin=\"normal\"\n            required={true}\n            label=\"Tiêu đề\"\n            variant=\"outlined\"\n            multiline\n            placeholder=\"Tiêu Đề\"\n            size=\"medium\"\n            fullWidth={true}\n            value={valueInput}\n            onChange={changeInputHandler}\n            onBlur={inputIsTouchedHandler}\n            error={!isValid && isTouched}\n          />\n          {!isValid && isTouched && (\n            <p className={styles.invalid}>Tiêu đề không được để trống</p>\n          )}\n          <label htmlFor=\"body-1\">Đoạn 1</label>\n          <TextField\n            id=\"body-1\"\n            margin=\"normal\"\n            label=\"Đoạn 1\"\n            variant=\"outlined\"\n            multiline\n            placeholder=\"Nội Dung 1\"\n            size=\"medium\"\n            fullWidth={true}\n            inputRef={contentRef}\n          />\n          <label htmlFor=\"body-2\">Đoạn 2</label>\n          <TextField\n            id=\"body-2\"\n            margin=\"normal\"\n            label=\"Đoạn 2\"\n            variant=\"outlined\"\n            multiline\n            placeholder=\"Nội Dung 2\"\n            size=\"medium\"\n            fullWidth={true}\n            inputRef={contentNextRef}\n          />\n          <label htmlFor=\"body-3\">Đoạn 3</label>\n          <TextField\n            id=\"body-3\"\n            margin=\"normal\"\n            label=\"Đoạn 3\"\n            variant=\"outlined\"\n            multiline\n            placeholder=\"Nội Dung 3\"\n            size=\"medium\"\n            fullWidth={true}\n            inputRef={contentThirdRef}\n          />\n          <Files gettingFiles={gettingFilesHandler} />\n          <Button type=\"submit\" className={styles.btn} variant=\"contained\">\n            Đăng bài!\n          </Button>\n        </form>\n        <CSSTransition\n          in={statusUploading === 'error' || !isValidImages || (data && status === 'completed') || (error && status === 'error')}\n          mountOnEnter\n          unmountOnExit\n          classNames=\"fade-light\"\n          timeout={500}\n        >\n          <>\n            <Inform>\n              {!isValidImages && <p>Upload tối thiểu 3 ảnh!</p>}\n              {error && status === 'error' && <p>Có lỗi xảy ra, xin thử lại sau</p>}\n              {data && status === 'completed' && \n              <div className={styles.success}>\n                <p>Tải bài viết lên thành công</p>\n                <div className={styles.information}>\n                  <p>Thông tin bài viết</p>\n                  <ul>\n                    <li>Tiêu đề: <span>{data.title}</span></li>\n                    <li>Nội dung 1: <span>{data.content1}</span></li>\n                    <li>Nội dung 2: <span>{data.content2}</span></li>\n                    <li>Nội dung 3: <span>{data.content3}</span></li>\n                  </ul>\n                </div>\n              </div>\n              }\n              <div\n                onClick={resetStateHandler}\n                className={styles[\"btn-close\"]}\n              >\n                <div></div>\n                <div></div>\n              </div>\n            </Inform>\n            {ReactDOM.createPortal(\n              <OverlayPortals />,\n              document.getElementById(\"overlay\")\n            )}\n          </>\n        </CSSTransition>\n      </Container>\n    </Layout>\n    </>\n  );\n};\n\nexport default FormPost;\n"]},"metadata":{},"sourceType":"module"}